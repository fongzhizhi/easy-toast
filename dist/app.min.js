var c;(function(s){s.Success="success",s.Error="error",s.Warn="warn",s.Info="info"})(c||(c={}));var u={type:c.Info,msg:"This is a toast message.",timer:3e3},p=`
<div id="<%= id %>" class="toast-panel">
    <div class="body <%= type %>">
        <div class="icon <%= icon %>"></div>
        <div class="msg"><%= msg-body %></div>
        <div class="btns">
            <div class="timer <%= timer-class %>"><%= timer %></div>
            <div class="close">x</div>
        </div>
    </div>
</div>`,h="toast-container",g=class{constructor(t){this.panelId="";this.calls=[];this.config=this.initConfig(t),!!this.config.msg&&this.show(this.createPanel())}static setContainer(t){this.container=t}static setMaxCount(t){this.maxCount=t||null}initConfig(t){let n=Object.assign({},u,t);return n.timer=Math.round(n.timer),n.timer<0&&(n.timer=u.timer),n}createPanel(){let t=this.config,n=Array.isArray(t.msg)?t.msg:[t.msg],i="";n.forEach(e=>{typeof e=="string"?i+=`<span>${e}</span>`:(e.class=e.class||"",e.call?(this.calls.push(e.call),i+=`<a href="#" class="${e.class}" call-index="${this.calls.length-1}">${e.text}</a>`):i+=`<span class="${e.class}">${e.text}</span>`)}),this.panelId="toast-"+new Date().getTime();let s=this.rendTemplate(p,{id:this.panelId,type:t.type,icon:"icon-toast-"+t.type,timer:this.convertPanelTimer(t.timer),"timer-class":t.timer===0?"hidden":"","msg-body":i}),l=document.createDocumentFragment();return new DOMParser().parseFromString(s,"text/html").body.childNodes.forEach(e=>l.append(e)),l.querySelector(".btns > .close").addEventListener("click",this.close.bind(this)),this.calls.length>0&&l.querySelectorAll("a[call-index]").forEach(e=>{e.addEventListener("click",o=>{let a=+o.target.getAttribute("call-index"),r=this.calls[a];r&&r.apply(null)})}),l}rendTemplate(t,n){if(!n||!t)return t;for(let i in n)t=t.replace(new RegExp(`<%=\\s*(${i})\\s*%>`,"g"),n[i]);return t}initContainer(){let t=document.createElement("div");return t.id=h,document.body.appendChild(t),t}convertPanelTimer(t){return Math.round(t/1e3||0).toString()}getPanel(){return document.getElementById(this.panelId)}getPanelTimerEle(){return this.getPanel().querySelector(".btns > .timer")}getPanelTimer(){return parseFloat(this.getPanelTimerEle().textContent)*1e3}updatePanelTimer(t){return this.getPanelTimerEle().textContent=this.convertPanelTimer(t)}show(t){if(!t)return;let n=document.querySelector(g.container);if(n||(n=this.initContainer()),g.maxCount>0){let e=n.querySelectorAll("* > .toast-panel"),o=e.length-g.maxCount+1;for(let a=0;a<o;a++){let r=e[a].querySelector(".btns > .close");r&&r.click()}}n.appendChild(t);let i="enter-in",s=this.getPanel();s.classList.add(i);let l=7;s.style.height=(s.clientHeight||44)+l+"px";let d=300;s.classList.add(i),setTimeout(()=>{s.classList.remove(i);let e=this.config.timer;if(e===0)return;if(e-=d,e<0){this.close();return}let o=1e3,a=300;this.updatePanelTimer(e),this.timerIntervalId=setInterval(()=>{let r=this.getPanelTimer()-o;r<a?setTimeout(()=>{this.close()},Math.max(0,r-a)):this.updatePanelTimer(r)},o)},d)}close(){let t=this.getPanel();if(!t)return;clearInterval(this.timerIntervalId),this.panelId="";let n=300;t.classList.add("leave-to"),setTimeout(()=>{t.parentElement.removeChild(t)},n)}},m=g;m.container="#"+h,m.maxCount=null;window.onload=()=>{document.querySelectorAll("#app .btn[action]").forEach(t=>{t.addEventListener("click",n=>{let i=n.target,s=i.getAttribute("action"),l=+document.getElementById("toast-max-count").value,d=+document.getElementById("toast-timer").value||0;m.setMaxCount(l);let e=document.getElementById("toast-msg").value,o=[e];if(i.hasAttribute("cycle")){o=[e,{text:"Show Next",call:()=>{i.click()}}];let a=[c.Success,c.Error,c.Warn,c.Info],r=a[a.indexOf(s)+1]||a[0];i.setAttribute("action",r)}new m({type:s,msg:o,timer:d})})})};
//# sourceMappingURL=app.js.map
