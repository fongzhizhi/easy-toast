var h=Object.defineProperty;var f=m=>h(m,"__esModule",{value:!0});var C=(m,e)=>{f(m);for(var n in e)h(m,n,{get:e[n],enumerable:!0})};C(exports,{Toast:()=>g,ToastType:()=>d});var d;(function(s){s.Success="success",s.Error="error",s.Warn="warn",s.Info="info"})(d||(d={}));var p={type:d.Info,msg:"This is a toast message.",timer:3e3},x=`
<div id="<%= id %>" class="toast-panel">
    <div class="body <%= type %>">
        <div class="icon <%= icon %>"></div>
        <div class="msg"><%= msg-body %></div>
        <div class="btns">
            <div class="timer <%= timer-class %>"><%= timer %></div>
            <div class="close">x</div>
        </div>
    </div>
</div>`,v="toast-container",c=class{constructor(e){this.panelId="";this.calls=[];this.config=this.initConfig(e),!!this.config.msg&&this.show(this.createPanel())}static setContainer(e){this.container=e}static setMaxCount(e){this.maxCount=e||null}initConfig(e){let n=Object.assign({},p,e);return n.timer=Math.round(n.timer),n.timer<0&&(n.timer=p.timer),n}createPanel(){let e=this.config,n=Array.isArray(e.msg)?e.msg:[e.msg],i="";n.forEach(t=>{typeof t=="string"?i+=`<span>${t}</span>`:(t.class=t.class||"",t.call?(this.calls.push(t.call),i+=`<a href="#" class="${t.class}" call-index="${this.calls.length-1}">${t.text}</a>`):i+=`<span class="${t.class}">${t.text}</span>`)}),this.panelId="toast-"+new Date().getTime();let s=this.rendTemplate(x,{id:this.panelId,type:e.type,icon:"icon-toast-"+e.type,timer:this.convertPanelTimer(e.timer),"timer-class":e.timer===0?"hidden":"","msg-body":i}),l=document.createDocumentFragment();return new DOMParser().parseFromString(s,"text/html").body.childNodes.forEach(t=>l.append(t)),l.querySelector(".btns > .close").addEventListener("click",this.close.bind(this)),this.calls.length>0&&l.querySelectorAll("a[call-index]").forEach(t=>{t.addEventListener("click",o=>{let a=+o.target.getAttribute("call-index"),r=this.calls[a];r&&r.apply(null)})}),l}rendTemplate(e,n){if(!n||!e)return e;for(let i in n)e=e.replace(new RegExp(`<%=\\s*(${i})\\s*%>`,"g"),n[i]);return e}initContainer(){let e=document.createElement("div");return e.id=v,document.body.appendChild(e),e}convertPanelTimer(e){return Math.round(e/1e3||0).toString()}getPanel(){return document.getElementById(this.panelId)}getPanelTimerEle(){return this.getPanel().querySelector(".btns > .timer")}getPanelTimer(){return parseFloat(this.getPanelTimerEle().textContent)*1e3}updatePanelTimer(e){return this.getPanelTimerEle().textContent=this.convertPanelTimer(e)}show(e){if(!e)return;let n=document.querySelector(c.container);if(n||(n=this.initContainer()),c.maxCount>0){let t=n.querySelectorAll("* > .toast-panel"),o=t.length-c.maxCount+1;for(let a=0;a<o;a++){let r=t[a].querySelector(".btns > .close");r&&r.click()}}n.appendChild(e);let i="enter-in",s=this.getPanel();s.classList.add(i);let l=7;s.style.height=(s.clientHeight||44)+l+"px";let u=300;s.classList.add(i),setTimeout(()=>{s.classList.remove(i);let t=this.config.timer;if(t===0)return;if(t-=u,t<0){this.close();return}let o=1e3,a=300;this.updatePanelTimer(t),this.timerIntervalId=setInterval(()=>{let r=this.getPanelTimer()-o;r<a?setTimeout(()=>{this.close()},Math.max(0,r-a)):this.updatePanelTimer(r)},o)},u)}close(){let e=this.getPanel();if(!e)return;clearInterval(this.timerIntervalId),this.panelId="";let n=300;e.classList.add("leave-to"),setTimeout(()=>{e.parentElement.removeChild(e)},n)}},g=c;g.container="#"+v,g.maxCount=null;
//# sourceMappingURL=Toast.js.map
